# Anlaz-Antey case

By school 30 from Nighniy Novgorod
# [Ru]
В этих репозиториях указана тестовая версия программы, которую позже можно встроить в систему, предложенную в документе

## Идеальная система

![Система ](https://i.imgur.com/iopIKTp.png)

Как известно, Нейросети – тяжелый процесс. Поэтому при возрастающей нагрузке может не хватит мощностей. Бесконечно делать вертикальное масштабирование (увеличение мощности железа) неправильно. Поэтому, надо разбивать систему на различные компоненты. Для этого прекрасно подходит микросервисная архитектура. Разобьем приложение на несколько сервисов. (обычно, сервис развернут на отдельном компьютере, сервере) 
Понадобятся такие сервисы, как:
-	**Nginx**   
Прокси запросов. Проксирует запросы на Application сервера (Если при расширении продукта понадобится их несколько).
-	**Application Server**
Сервер приложения, предоставляющий API для источников информации, передает информацию о новых пожарах. Ядро приложения.
-	**Redis**
Чтобы не трясти постоянную базу данных, частые запросы можно кешировать, и удалять кеш, если данные устарели. Application сервер теперь обращается к Redis, и если такого кеша нет, тогда к базе данных.
-	**PostgreSQL Database**
Хранилище данных о пожарах, статистике, и так далее.
-	**AI server**  
Сервер обработки картинок о пожаре нейросетями.
-	**Message Broker**
У нас получается несколько application серверов, несколько AI серверов. А если во время выполнения операции кто-то выключится. На помощь придет брокер сообщений. На него будут поступать все задачи и их статус. Если даже один из сервисов перезагрузится, записи останутся в брокере и этот сервис сделает их заново.
-	**Kubernetes** 
Оркестратор контейнеров. Его работа описывается более подробнее в выводе. Может сам лечить свои компоненты
### Вывод
Получается отказоустойчивая система, но сложная в управлении. Кто постоянно будет заниматься управлением этим количеством серверов? Для таких вещей проще всего упаковать наше приложение в docker container. Контейнер – это само приложение со всеми его зависимостями. А управляет этим оркестратор контейнеров – Kubernetes. После настройки он сможет автоматически увеличить кол-во тех или иных серверов, перезагрузить проблемные сервисы и многое другое.
___

##  Наша система
#### Запуск
* Скачать [service-application](https://github.com/Almaz-Antey-Sirius-school30nn/service-application) и [service-ai](https://github.com/Almaz-Antey-Sirius-school30nn/service-ai)
* Запустить и настроить оба приложения по инструкции в них (readme.md файл)
 #### Использование
| Метод | Заголовки     | Тело              | Адрес                   |
|-------|---------------|-------------------|-------------------------|
| POST  | fname, token  | картинка |SERVER_ADDRESS/api/photo |

SERVER_ADRESS - адрес сервера (по умолчанию: "localhost:5000" )
fname - имя файла (файл для сохранения)
token - ключ доступа (задается в настройках приложения)

Ответ сервера:
```sh
OK
```

Если будет найден пожар, информация об этом отправится на сервер мчс (задается настройках в приложения)


___

## Точность распознавания
Система определяет объект на пожаре очень точно, вот несколько примеров

(Пожар подсвечивается синим прямоугольником)

![](https://i.imgur.com/awhlr94.png)
![](https://i.imgur.com/X0cBHJl.png)
![](https://i.imgur.com/JIFotqN.png)
